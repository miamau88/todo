fetch("http://localhost:5000/todos").then(res=>res.json()).then(res=>{todos=res,list(),check()});let todos=[];function list(){console.log(todos);const ul=document.querySelector("ul"),li=document.querySelector("li"),todoMap=todoslist=>`<li class='todo-list ${"false"!==todoslist.completed?"completed":""}' data-id="${todoslist.id}">\n          <div class="checkBox"><input type='checkbox' id='chkList${todoslist.id}'\n          ${"false"!==todoslist.completed?"checked":""}>\n          <label for='chkList${todoslist.id}'></label></div>\n          <div class="todo-title">${todoslist.title}</div>\n          <button class="btndel">x</button></li>`;ul.innerHTML=todos.map(todoMap).join("");const btnDel=document.querySelectorAll(".btndel");for(let i=0;i<btnDel.length;i++)btnDel[i].addEventListener("click",e=>{const id=e.target.parentNode.dataset.id;console.log(id),fetch(`http://localhost:5000/todos/1/${id}`,{method:"DELETE"}).then(()=>{todos.splice(i,1),e.target.parentNode.remove(),console.log(todos)}).catch(err=>alert(err))})}function check(){const check=document.querySelectorAll("input[type='checkbox']");for(let i=0;i<check.length;i++)check[i].addEventListener("click",e=>{const eli=e.target.closest("li"),completed="true"==todos[i].completed?"false":"true";fetch(`http://localhost:5000/todos/${todos[i].userId}/${todos[i].id}`,{method:"PATCH",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({completed:`${completed}`})}).then(()=>{if(!0!==check[i].checked)return eli.classList.remove("completed"),todos[i].completed="false",void console.log(todos[i].completed);eli.classList.add("completed"),todos[i].completed="true"}).catch(err=>alert(err)),console.log(todos[i].completed)})}document.querySelector("#add-btn").addEventListener("click",e=>{if(e.target.classList.contains("add")){const input=document.querySelector(".todo-txtInput");let id=0!==todos.length?Number(todos[todos.length-1].id)+1:1;if(0==input.value)return alert("내용을 입력하세요");fetch("http://localhost:5000/todos/1",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({title:input.value})}).then(res=>res.json()).then(res=>{todos.push({id:id,title:input.value,completed:"false"}),list(),check()}).catch(err=>alert(err))}});