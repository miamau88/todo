<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .a {
        color: gray;
      }
    </style>
  </head>
  <body>
    <input type="text" />
    <button class="btn add">add</button>
    <ul></ul>
    <script>
       // 3회차 과제
      // 1. 리스트 출력되도록 코드 수정
      // 2. 삭제 버튼 클릭하면 배열에서 삭제, 목록에서도 제거
      // 3. add 버튼 누르면 항목 추가 (id 1씩 증가)
      const todos = [
        {
          id: "1",
          title: "a제목입니다",
          completed: 0,
        },
        {
          id: "2",
          title: "b제목입니다",
          completed: 1,
        },
      ];
      list();
      check();      
      function list() {
        //기존 배열 리스트 추가
        let chk1 = 0
        const ul = document.querySelector("ul");
        const li = document.querySelector("li");        
        const todoMap = (todoslist =>    {               
        check();
        return `<li>          
          <input type='checkbox' ${todoslist.completed !== 0 ? 'checked' : ''}>
          ${todoslist.id}&nbsp;&nbsp
          ${todoslist.title}&nbsp;&nbsp;          
          ${todoslist.completed == 0 ? `${todoslist.completed}<a>미확인</a>` : `${todoslist.completed}<a>체크완료</a>`}  &nbsp;&nbsp;          
          <button class="btndel">삭제</button></li>`          
        });
         
        
          ul.innerHTML = todos.map(todoMap).join("");
          const btnDel = document.querySelectorAll(".btndel");
          
        // 삭제
        for (let i = 0; i < btnDel.length; i++) {
          btnDel[i].addEventListener("click", (e) => {
            todos.splice(i, 1);
            e.target.parentNode.remove();
            console.log(todos);
          });
        }        
      }
      function check(){
      const a = document.querySelectorAll('a')      
      const check = document.querySelectorAll('input[type=checkbox]');            
        for (let i=0; i < check.length; i++){
          check[i].addEventListener('click', (e) => {            
          check[i].checked !== true ? a[i].classList.remove('a') : a[i].classList.add('a');
          check[i].checked == true ? todos[i].completed = 1 : todos[i].completed = 0;                                    
          check[i].checked == true ? a[i].innerText = `체크완료` : a[i].innerText=  `미확인`                  
          console.log(todos[i].completed);          
        });                    
        }
      }
      // 이벤트위임
      document.querySelector("body").addEventListener("click", (e) => { 
        if (e.target.classList.contains('add')) {
          const input = document.querySelector('input');
          let id = todos.length !== 0 ? Number(todos[todos.length-1].id)+1 : 1 ;
          input.value == 0  ? alert('값없음') : todos.push({id:id,title: input.value,completed: 1}) ;
          list();
          check();
        }
          
        });

      // 4회차 과제
      // input에 값이 없을 때 예외처리
      // completed 값이 1이면 완료한거니 글자를 회색으로 처리 (class 이용)
      // li에 체크박스 추가
    </script>
  </body>
</html>
